"use strict";(globalThis.webpackChunkt_1_c_docs=globalThis.webpackChunkt_1_c_docs||[]).push([[986],{8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>c});var r=i(6540);const s={},a=r.createContext(s);function l(e){const n=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),r.createElement(a.Provider,{value:n},e.children)}},9321:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>t,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"spikeyolo-v8-tracker/training","title":"Training Guide","description":"Overview","source":"@site/docs/spikeyolo-v8-tracker/training.md","sourceDirName":"spikeyolo-v8-tracker","slug":"/spikeyolo-v8-tracker/training","permalink":"/docs/spikeyolo-v8-tracker/training","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"tutorialSidebar","previous":{"title":"Configuration Guide","permalink":"/docs/spikeyolo-v8-tracker/configuration"},"next":{"title":"Evaluation Guide","permalink":"/docs/spikeyolo-v8-tracker/evaluation"}}');var s=i(4848),a=i(8453);const l={sidebar_position:6},c="Training Guide",t={},o=[{value:"Overview",id:"overview",level:2},{value:"Quick Start",id:"quick-start",level:2},{value:"Basic Training",id:"basic-training",level:3},{value:"High-Frequency Training",id:"high-frequency-training",level:3},{value:"Training Scripts",id:"training-scripts",level:2},{value:"Main Training Script",id:"main-training-script",level:3},{value:"Hyperparameter Search",id:"hyperparameter-search",level:3},{value:"Training Parameters",id:"training-parameters",level:2},{value:"Command-Line Arguments",id:"command-line-arguments",level:3},{value:"Configuration File Parameters",id:"configuration-file-parameters",level:3},{value:"Training Optimizations",id:"training-optimizations",level:2},{value:"1. Warmup Learning Rate Schedule",id:"1-warmup-learning-rate-schedule",level:3},{value:"2. Adjusted Loss Function Balance",id:"2-adjusted-loss-function-balance",level:3},{value:"3. Increased Training Epochs",id:"3-increased-training-epochs",level:3},{value:"4. Prioritized Annotated Windows",id:"4-prioritized-annotated-windows",level:3},{value:"5. Increased Sample Diversity",id:"5-increased-sample-diversity",level:3},{value:"6. Focal Loss for Hard Examples",id:"6-focal-loss-for-hard-examples",level:3},{value:"7. SGD Optimizer with Momentum",id:"7-sgd-optimizer-with-momentum",level:3},{value:"8. Cyclic Learning Rate",id:"8-cyclic-learning-rate",level:3},{value:"9. Label Smoothing",id:"9-label-smoothing",level:3},{value:"10. Temporal-Aware Processing",id:"10-temporal-aware-processing",level:3},{value:"Training Process",id:"training-process",level:2},{value:"Dynamic Batching",id:"dynamic-batching",level:3},{value:"Training Log Example",id:"training-log-example",level:3},{value:"Monitoring Training",id:"monitoring-training",level:2},{value:"GPU Monitoring",id:"gpu-monitoring",level:3},{value:"Log Files",id:"log-files",level:3},{value:"Expected Performance",id:"expected-performance",level:2},{value:"Combined Optimizations Impact",id:"combined-optimizations-impact",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Common Issues",id:"common-issues",level:3},{value:"Debug Mode",id:"debug-mode",level:3},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"training-guide",children:"Training Guide"})}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"SpikeYoloV8-Tracker provides a comprehensive training pipeline with configurable hyperparameters, advanced training techniques, and robust logging."}),"\n",(0,s.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,s.jsx)(n.h3,{id:"basic-training",children:"Basic Training"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"python scripts/training/comprehensive_training.py \\\n    --slice_duration_us 100 \\\n    --time_steps 8 \\\n    --batch_size 8\n"})}),"\n",(0,s.jsx)(n.h3,{id:"high-frequency-training",children:"High-Frequency Training"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"python scripts/training/comprehensive_training.py \\\n    --slice_duration_us 100 \\\n    --time_steps 8 \\\n    --batch_size 8 \\\n    --max_epochs 100 \\\n    --learning_rate 1e-3 \\\n    --device cuda\n"})}),"\n",(0,s.jsx)(n.h2,{id:"training-scripts",children:"Training Scripts"}),"\n",(0,s.jsx)(n.h3,{id:"main-training-script",children:"Main Training Script"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": ",(0,s.jsx)(n.code,{children:"scripts/training/comprehensive_training.py"})]}),"\n",(0,s.jsx)(n.p,{children:"This is the primary script for training the model. It supports:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Configurable training parameters"}),"\n",(0,s.jsx)(n.li,{children:"Learning rate scheduling"}),"\n",(0,s.jsx)(n.li,{children:"Warmup epochs"}),"\n",(0,s.jsx)(n.li,{children:"Multiple optimizers (SGD, AdamW)"}),"\n",(0,s.jsx)(n.li,{children:"Comprehensive logging"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"hyperparameter-search",children:"Hyperparameter Search"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Location"}),": ",(0,s.jsx)(n.code,{children:"scripts/training/hyperparameter_search.py"})]}),"\n",(0,s.jsx)(n.p,{children:"Automated hyperparameter optimization:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"python scripts/training/hyperparameter_search.py\n"})}),"\n",(0,s.jsx)(n.h2,{id:"training-parameters",children:"Training Parameters"}),"\n",(0,s.jsx)(n.h3,{id:"command-line-arguments",children:"Command-Line Arguments"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"--slice_duration_us"}),": Time window duration in microseconds (default: 100)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"--time_steps"}),": Number of temporal steps (default: 8)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"--batch_size"}),": Batch size (default: 8)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"--max_epochs"}),": Maximum training epochs (default: 25)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"--learning_rate"}),": Initial learning rate (default: 0.001)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"--device"}),': Device to use (default: "cuda")']}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"configuration-file-parameters",children:"Configuration File Parameters"}),"\n",(0,s.jsxs)(n.p,{children:["See ",(0,s.jsx)(n.a,{href:"./configuration",children:"Configuration Guide"})," for all configurable parameters."]}),"\n",(0,s.jsx)(n.h2,{id:"training-optimizations",children:"Training Optimizations"}),"\n",(0,s.jsx)(n.h3,{id:"1-warmup-learning-rate-schedule",children:"1. Warmup Learning Rate Schedule"}),"\n",(0,s.jsx)(n.p,{children:"Gradual learning rate increase prevents cold start issues:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'def warmup_learning_rate(optimizer, epoch, warmup_epochs, base_lr):\n    """Apply linear warmup learning rate."""\n    if epoch < warmup_epochs:\n        lr = base_lr * (epoch + 1) / warmup_epochs\n        for param_group in optimizer.param_groups:\n            param_group[\'lr\'] = lr\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Configuration"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"training:\n  warmup_epochs: 3\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Expected Impact"}),": +15-25% mAP"]}),"\n",(0,s.jsx)(n.h3,{id:"2-adjusted-loss-function-balance",children:"2. Adjusted Loss Function Balance"}),"\n",(0,s.jsx)(n.p,{children:"Stronger emphasis on bounding box localization:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"yolo_loss:\n  box_loss_weight: 5.0  # Increased from 2.0\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Expected Impact"}),": +10-20% mAP"]}),"\n",(0,s.jsx)(n.h3,{id:"3-increased-training-epochs",children:"3. Increased Training Epochs"}),"\n",(0,s.jsx)(n.p,{children:"More time for model to learn spatial relationships:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"training:\n  epochs: 25  # Increased from 5\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Expected Impact"}),": +10-15% mAP"]}),"\n",(0,s.jsx)(n.h3,{id:"4-prioritized-annotated-windows",children:"4. Prioritized Annotated Windows"}),"\n",(0,s.jsx)(n.p,{children:"Larger temporal buffer captures more annotations:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"data_processing:\n  temporal_buffer: 0.2  # Increased from 0.1\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Expected Impact"}),": +20-30% mAP"]}),"\n",(0,s.jsx)(n.h3,{id:"5-increased-sample-diversity",children:"5. Increased Sample Diversity"}),"\n",(0,s.jsx)(n.p,{children:"Better dataset coverage:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"data_processing:\n  max_samples_per_file: 50  # Increased from 30\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Expected Impact"}),": +15-25% mAP"]}),"\n",(0,s.jsx)(n.h3,{id:"6-focal-loss-for-hard-examples",children:"6. Focal Loss for Hard Examples"}),"\n",(0,s.jsx)(n.p,{children:"Focuses learning on hard-to-classify examples:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"yolo_loss:\n  use_focal_loss: true\n  focal_alpha: 0.25\n  focal_gamma: 2.0\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Expected Impact"}),": +10-15% mAP"]}),"\n",(0,s.jsx)(n.h3,{id:"7-sgd-optimizer-with-momentum",children:"7. SGD Optimizer with Momentum"}),"\n",(0,s.jsx)(n.p,{children:"Better for localization tasks:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'training:\n  optimizer: "sgd"\n  momentum: 0.9\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Expected Impact"}),": +5-10% mAP"]}),"\n",(0,s.jsx)(n.h3,{id:"8-cyclic-learning-rate",children:"8. Cyclic Learning Rate"}),"\n",(0,s.jsx)(n.p,{children:"Helps escape poor local minima:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'training:\n  lr_scheduler: "cyclic"\n  max_learning_rate: 0.002\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Expected Impact"}),": +5-10% mAP"]}),"\n",(0,s.jsx)(n.h3,{id:"9-label-smoothing",children:"9. Label Smoothing"}),"\n",(0,s.jsx)(n.p,{children:"Prevents overconfidence:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"yolo_loss:\n  label_smoothing: 0.1\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Expected Impact"}),": +5-10% mAP, better calibration"]}),"\n",(0,s.jsx)(n.h3,{id:"10-temporal-aware-processing",children:"10. Temporal-Aware Processing"}),"\n",(0,s.jsx)(n.p,{children:"Preserves fine-grained temporal information:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Removed temporal aggregation that was averaging across time"}),"\n",(0,s.jsx)(n.li,{children:"Loss computed separately for each temporal step"}),"\n",(0,s.jsx)(n.li,{children:"Better temporal matching"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Expected Impact"}),": +15-25% mAP"]}),"\n",(0,s.jsx)(n.h2,{id:"training-process",children:"Training Process"}),"\n",(0,s.jsx)(n.h3,{id:"dynamic-batching",children:"Dynamic Batching"}),"\n",(0,s.jsx)(n.p,{children:"The training process uses dynamic batching:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Sample Calculation"}),": Exact number of samples calculated per file"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Overlapping Windows"}),": 25% overlap ensures complete coverage"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Temporal Matching"}),": Annotations matched to specific event windows"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"training-log-example",children:"Training Log Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"INFO: Temporal matching: 10000 events [1000000-1000999\u03bcs] -> 15 annotations\nINFO: Temporal matching: 10000 events [2000000-2000999\u03bcs] -> 23 annotations\nINFO: Epoch 1, Batch 100/1400: Total Loss = 0.723692, Box Loss = 0.000000, \n      Class Loss = 0.000000, Obj Loss = 0.361720, Track Loss = 0.000168\n"})}),"\n",(0,s.jsx)(n.h2,{id:"monitoring-training",children:"Monitoring Training"}),"\n",(0,s.jsx)(n.h3,{id:"gpu-monitoring",children:"GPU Monitoring"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Check GPU status\nnvidia-smi\n\n# Real-time monitoring\nwatch -n 1 nvidia-smi\n"})}),"\n",(0,s.jsx)(n.h3,{id:"log-files",children:"Log Files"}),"\n",(0,s.jsx)(n.p,{children:"Training logs are automatically saved to:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"{model.logs_dir}/training_{timestamp}.log\n"})}),"\n",(0,s.jsx)(n.p,{children:"Logs include:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Training progress"}),"\n",(0,s.jsx)(n.li,{children:"Loss values"}),"\n",(0,s.jsx)(n.li,{children:"Learning rate schedules"}),"\n",(0,s.jsx)(n.li,{children:"File processing information"}),"\n",(0,s.jsx)(n.li,{children:"Temporal matching statistics"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"expected-performance",children:"Expected Performance"}),"\n",(0,s.jsx)(n.h3,{id:"combined-optimizations-impact",children:"Combined Optimizations Impact"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Total mAP Improvement"}),": +75-100% (from 0% to meaningful values)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Training Time"}),": ~1.3-1.6x longer due to more epochs and SGD"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Rationale"}),": Focal loss + SGD + cyclic LR + label smoothing = robust model"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,s.jsx)(n.h3,{id:"common-issues",children:"Common Issues"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Out of Memory"}),": Reduce batch size or ",(0,s.jsx)(n.code,{children:"max_events_per_sample"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Slow Training"}),": Check GPU utilization, reduce ",(0,s.jsx)(n.code,{children:"prefetch_factor"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Poor Convergence"}),": Adjust learning rate, check data loading"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Zero mAP"}),": Verify temporal matching, check annotation format"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"debug-mode",children:"Debug Mode"}),"\n",(0,s.jsx)(n.p,{children:"Enable detailed logging:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'# In config.yaml\nlogging:\n  level: "DEBUG"\n'})}),"\n",(0,s.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"./evaluation",children:"Evaluation Guide"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"./performance",children:"Performance & Optimizations"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);